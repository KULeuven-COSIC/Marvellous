load("instance_generator.sage")

##########################################################
## rescue381 parameters
##########################################################
## use rescue381 to check the correctness of key_injection function

q254 = 21888242871839275222246405745257275088548364400416034343698204186575808495617
rescue254 = Rescue(128, q254, 4, 5)

##########################################################
## print parameters
##########################################################
import sys
def convert_bytes(input):
	res = []
	for v in input:
		res.append(int(v))

	res_str = "["

	for v in res:
		res_str +="0x%02X," % v

	res_str += "],"
	res_str = res_str.replace(",]", "]")

	return res_str
print("==========================\n")

for v in rescue254.constants_matrix:
    for e in v:
        print(convert_bytes(int.to_bytes(int(e), 32, 'little')))

# for e in init_vec_377:
#     print(convert_bytes(int.to_bytes(int(e), 32, 'little')))
# print("==========================\n")
#
#
# for e in key_injection_377:
#     print("[")
#     for f in e:
#         print(convert_bytes(int.to_bytes(int(f), 32, 'little')))
#     print("],")
# print("==========================\n")
#
# for e in permutation_round_key:
#     print(convert_bytes(int.to_bytes(int(e), 32, 'little')))
# print("==========================\n")
#

print("==========================\n")
print("init vector")
for e in rescue254.initial_constant:
	print(convert_bytes(int.to_bytes(int(ZZ(e[0])), 32, 'little')))


def key_injection(init_vec, key_sched_matrix, key_sched_vec, q):
    key_injection = []
    k = (init_vec * key_sched_matrix + key_sched_vec) % q
    key_injection.append(k)
    for i in range(1, 24):
        k = (key_injection[i-1] * key_sched_matrix + key_sched_vec) % q
        key_injection.append(k)
    return key_injection


init_vec_254 = vector([ZZ(e[0]) for e in rescue254.initial_constant])
key_sched_vec_254 = vector([ZZ(e[0]) for e in rescue254.constants_constant])


key_sched_matrix_254 = matrix(ZZ, 4, 4)
for i in range(4):
	for j in range(4):
		key_sched_matrix_254[i,j] = ZZ(rescue254.constants_matrix[i][j])
key_sched_matrix_254 = key_sched_matrix_254.transpose()

key_injection_254 = key_injection(init_vec_254, key_sched_matrix_254, key_sched_vec_254, q254)

print("==========================\n")
print("key injection")
for e in key_injection_254:
    print("[")
    for f in e:
        print(convert_bytes(int.to_bytes(int(f), 32, 'little')))
    print("],")
print("==========================\n")

permutation_round_key = []
permutation_round_key.append(0x204EF5195A249AF9F0ECAFA3E5D186D6318A5AF08A0CEB9731351045082151D3)
permutation_round_key.append(0x00D525FBB687D48648B6A0FFBF1C9E97BE39CFF22D46AA165C3278A5DD953D6F)
permutation_round_key.append(0x10B1159C4FDEAD8C4E6BA55D1BC8338364A6C05EEF88185F72DA1F178B613EA4)
permutation_round_key.append(0x0823FA86ED409E6816795278DAC56B0E475E16C412FB04EE260BB3B55DB81736)
permutation_round_key.append(0x293FC7D601BACD3C0284DF170B21DDDAB70C60C3DE919E3799CBA305354A593A)
permutation_round_key.append(0x1151C53F7F7FF7413E04D66C516CC3FAAA38B3B59EFE62CDD16BB9A48380B13F)
permutation_round_key.append(0x2F198A2C4615AC524E724BC229FC8F4FFB57AC86812CCC8F4608F9D08DE22D1C)
permutation_round_key.append(0x177034F8DD1F6DA5C3FCD25F4CCE79E082153DBA89A1587C2190C9EF287616B2)
permutation_round_key.append(0x07814ED3EB736D73804ADA7BC25507DB0D7E374369C010C691DD65386C4EFA8D)
permutation_round_key.append(0x28C30510D747A6A641CD7C81C2B8273C3DEEFA3366AF02E482BFEB806232D5F6)
permutation_round_key.append(0x14854753E3C7E4E50B1E0E518E99F0E54AFE1C82088C1935BCACC286FB64F5B5)
permutation_round_key.append(0x1047BD5F58C7BC8E500FCD4038744A6F8FCF114448526C6AE4ABBCF0F390957E)
permutation_round_key.append(0x00ADCF20CDEFE156D31F685C92C4C754FB216B09EAB182E5750F53A1DF6ADD2D)
permutation_round_key.append(0x2DFDABF83E149F597560FF354951C0A0DA6AB955B50E6CDF8D45210B6BA3B539)
permutation_round_key.append(0x2BACB2154E2FD046D124F23427E218F60CFDD290877FD80E89E81223D92D2FEA)
permutation_round_key.append(0x080030FE806BD9E4C2FC56DD2064B48020F3743A02D5D5EF735C19D7F5351EC3)
permutation_round_key.append(0x05C1E7E3B39CEA62ED567BBDD4AF6AA3172B0ACE17480B7631DEC55D26F2AE21)
permutation_round_key.append(0x2F36E6AA6047766AA0AB108A0D9C608C7ABCB7E1C36EDADD813267AA61EEF503)
permutation_round_key.append(0x0117010F3E7BE4BAD697CB596DED269BDCE41CB5E4F5DF321FC36B8297C8DEF8)
permutation_round_key.append(0x12C88AE9E997682F6E64358D6BC2B98F14B22570FFAD3896C6EE610C0D9BF872)
permutation_round_key.append(0x2281E9C8494480EC1144C41F401BC42C6993CB1C244C3EC2D55079C8D1D3F5F3)
permutation_round_key.append(0x242399FD277EC35AB303F398FB09B832828C0B7DADFC004CEB0FBA84331A4383)
permutation_round_key.append(0x2E9E0E672CC6A26E6BFD72800937D17F84AAFC14FE34F2E117210FE16216A014)
permutation_round_key.append(0x2DA20060D27DA3C2B99F4BAF512E53CE5D3223FD13CB3286D141B29EED7E113F)
permutation_round_key.append(0x0D4CB3EEE3996BA8F6793BB402E88D4405AA1081B0A37B78C7779C3D340F1960)
permutation_round_key.append(0x1BA1DB73659B3B23BD6A6AF953113676161828012C3AC346002DE9E0DCF0C43D)
permutation_round_key.append(0x17D86473DD04A5F188819B5C7F2FD37FEC9547A3501C5BC5FD24A02EE30BC0B0)
permutation_round_key.append(0x0C4CA620D3FD1B4131F3A8B69AC3D5372523F2BF156A0DE7EE6265F1DDAC6979)
permutation_round_key.append(0x0A2392AE4051FE491D971E19A1B2065625C2A352BE8E1122F28F647445A632F0)
permutation_round_key.append(0x11FCAD5E34183C64E5B30F231A984C9A2D4D2F1AD82952C694C3C705049F7816)
permutation_round_key.append(0x0A0176D71D3B0C7AC238CA77529FA7B933A086FA3BFDCB414FFA5E2DA9DF4B00)
permutation_round_key.append(0x059C2C2688D5D8ADA8FF683CFFD98A228B6A1B195B53640501B1C21237F3854F)
permutation_round_key.append(0x0F61F39A3558851CB791332E7DBEBEC12B7A43AEA2F998B6DB4600A80374B6ED)
permutation_round_key.append(0x25E1A9D62BAB29BB8FB5909517F1D47859F5673F8A2B2CC9DD7C870EDA7B0FC5)
permutation_round_key.append(0x2E3C03DEE44661150DB8756977960CF0424C8722ADBDD647FD468136FD5BB40F)
permutation_round_key.append(0x235FD01177EA0B664DDA5A1C09278F4160369EFC76234C42FAB4E27796B8EBCD)
permutation_round_key.append(0x169BD072A166986E826D5173764C5830CF0DF28A54FAC9EFB8B14D14E4AB44CC)
permutation_round_key.append(0x29165DFDE70C541233D7779BFFE5E4A5D51CE188051C8B4219176836C89C8032)
permutation_round_key.append(0x147B071502D5AB6D5C36C904AAD61596425648BD04B59041C9467D1C997D40CA)
permutation_round_key.append(0x2EA3E4DF1EB00B56B191C888AAE9DF7A27B1AAF7F42C07D7FDF4C429F3222C90)
permutation_round_key.append(0x05E7D24CC9BEAD53442604076A931FF1141EEAC9DF9612665AAF279FEFC56DEF)
permutation_round_key.append(0x2AD3FDAB692F986698DCBF75BAD7997C69656BFAA12C3D018DBD9756F93B2E7F)
permutation_round_key.append(0x0C11AAA440C3E58F338902CEC6F8D69BDD72AF59C2AF99023A5997C5A68E97DF)
permutation_round_key.append(0x10383793760804678052E5585308FDEBE58EB196CA0B8CDA4D232C4F5DD206E2)
permutation_round_key.append(0x16E2B4A08B6639F2A3AB1DB440AC11C96AC7D6A6B622145F9966759785F58918)
permutation_round_key.append(0x1768B6D0BBABD43B4D8933E7983893B17544BFB5BC859064BD7CFD84A395E838)
permutation_round_key.append(0x1FAEA6415E680069D5206A3C67464D7F69EB518F1B1DFD2CB33012D65C91E313)
permutation_round_key.append(0x2DE153E0B9E0DD03EFF09C7968C5731799E5160093602B927B352D54059471EC)
permutation_round_key.append(0x2ADE9A93522E2E0D9BF61DD2B88F64CC1DF63A68121C07506BDEEA0E6098C536)
permutation_round_key.append(0x0938220A701623E1FD7A5F533A663D90AC5A51825C8BED809125D24EBDD8FD10)
permutation_round_key.append(0x06AA537ACE0534E58D88CE2046010A57EEB22544B8A4697483D60C4638D8CB72)
permutation_round_key.append(0x1F9541C705B95EF90255B1A5FB64051AB1909F23A3DCE6B659E9969523D34FC5)
permutation_round_key.append(0x23DEBB8C003021369A7969A8282A71C305565849020582EFCD3E892446E50FF9)
permutation_round_key.append(0x0BF2CA96451CBB14A262B0E915FFF1AEC62D2ACCD7C3C6C5944C281AF35D6377)
permutation_round_key.append(0x2C7F9809CACE0068AFC0DE88A31764989D1911B8565BE322CCE2613812B4358E)
permutation_round_key.append(0x210771D9375A0643B6570AC88F3652E77F0E7203B9A7E574821B5F63DFD10EEC)
permutation_round_key.append(0x0067FE55293C933F98E59FAF05EAF3EAA1AF21626CFC1F96A21B85234752F476)
permutation_round_key.append(0x21F8F1341F5053B5439CDCE11D696FBEC69D44A348535EA782CC5C2171B9AC8B)
permutation_round_key.append(0x16419AC8F54DC6D18476D752BBFFCAFCF180418089DDF8212092D96EF069AEA5)
permutation_round_key.append(0x0AAA4EA3D4A62822C9D5CF275C43975BF683708C78B9C093BB43C5F6F17949E6)
permutation_round_key.append(0x0C37D733050F604F2B0E395A3EBB3784F55EE9710E9A0C5E06B4667FBC8BC42A)
permutation_round_key.append(0x2824F5B6C26E8477A10DD00BD2F0CDE0B1B6A4A491CFC97563001805317EA6C3)
permutation_round_key.append(0x01B25BF1E4DF63B5BF06B83D2C3E2BA06ED0597BEE28C9DB9122CC31650FA397)
permutation_round_key.append(0x240B67813EFFBB5F06110957159335241F5DCFEA620E4FCE7B2B9A3760408D39)
permutation_round_key.append(0x2236CD86C8D65CB72AA00BCF7296C58A28B849A690E31165D2302F8466CAFF04)
permutation_round_key.append(0x20390ED18182DCB8DAEA043B93AA2B98CA95AB429FF2CA7027DB4A27350FBF36)
permutation_round_key.append(0x1E643CDB387382849957ECF0D99F3115A5C208E59446B7DE803478245ED6EAE2)
permutation_round_key.append(0x1E854BA31F89059506F766B129793D5A134296516D3F88B841155468F4C294C7)
permutation_round_key.append(0x07CA4952BE421A53C307F49858F7F2E1C6CBA4B3F6F87ACB7F6F291DD59091C2)
permutation_round_key.append(0x131591C541DD94F41E2B7754A4109B4D2EAA0C934E9030C8BB1285E7F26E8F06)
permutation_round_key.append(0x2CDD8E8A6C5A6CFCAB40087C5546DCA55D52E0FA92FD5F8968682BD8A4ED0584)
permutation_round_key.append(0x10C3F10B28BEB6599E5B8EE9B2226EA9A25C796BD0630C9540BC864727EA6C5C)
permutation_round_key.append(0x10B8439F8B5FD9C23E18EC554DC0909D73D488407E6CE9461B2366E600E9CB89)
permutation_round_key.append(0x1C0E2DD3E1E31BA125D58C9393862F6C234BDB81FA1F7069176C8666A14AF97B)
permutation_round_key.append(0x305EBC67B8583CC608DDB46561C6573315855A1F8DBD93F9B8C54C61A0972EBD)
permutation_round_key.append(0x079496612E6A96E6E973DA23508E0FF256BB0B67EE984B3A2C637D85CE84CDE7)
permutation_round_key.append(0x05A4CD4D2576AC3BAC78003E9B0D75D77781162F562525954A8F1F9CAB7ED4B3)
permutation_round_key.append(0x1E4DBB96D44D70ABC545B8B41D65772D4989FD6D0B1D9CC7B68830127E00167E)
permutation_round_key.append(0x2BBEA759CBE13E9047B344BECB11FEE7D54F9445A4BFB6CF460EE55C85117BAE)
permutation_round_key.append(0x1A03EE9282492493002D081BD9FDFBFAB2FCE79E734C285AAF3B600D72894C12)
permutation_round_key.append(0x02D0AC662607BF9E018A13D43DA00F1C17A80223E53011CA97FE54FE7023BD28)
permutation_round_key.append(0x2CB74B97AA5A0461E4A0A6E288D99C0905AEE732C9CECABE4615EBD5A104B333)
permutation_round_key.append(0x1CFACCCB910A37FBFD67B2996EC2424A9CB2E2A1D7870A61A806C7B6EE7386F5)
permutation_round_key.append(0x1760B5A3DEC431D5011334C195DE57558119F457FB5DBFD6FB88A3A52C557388)
permutation_round_key.append(0x2F483362E91E5828FF12621ACA5AE5874AE430A3EBD86DA588F90D30A96A5F0F)
permutation_round_key.append(0x22CE5EFA27F62C09D2BCD85EBD23D78840A5D6B68D2633417053EDC66CC1AF4D)
permutation_round_key.append(0x23EDD1DE61C495E392254D4992EEC9B59A5D4598684E6DB46D0E0E4F7E0F28B6)
permutation_round_key.append(0x0BFBB36D010F34C54891C925A46B5A9B1D0ACC7BFE443050BFD0DCBAA3C816C7)
permutation_round_key.append(0x202E297F6EDE5F8859F39A8CD0C7F0E97F5443821F0261DE729EBD5828D167D7)
permutation_round_key.append(0x21AEABF98B919A79ACB5A61DA8B0CE8EAFDDAA6264DA67A7F93D0F5278B545DA)
permutation_round_key.append(0x2B3E91F8C87544D3BFFAE1237B88F932946BE37354EB3FE75FF3F94D07C15D52)
permutation_round_key.append(0x304F9EC93C84CB215401077E145FFC7ED63BE01DAE7C8244BA1824025EAB8016)
permutation_round_key.append(0x2A2CE6212084C0FD8257C35B7DCF4866C93B17928D4FEBEAD535E36BD3E24C85)
permutation_round_key.append(0x2A4C632E0C6BFD734E93B4EF7AFF2765E15ABEBD4A7A1981AEC2B485D700CB49)
permutation_round_key.append(0x0E9AF43AB6258D55F5B9BA7A5C1B17068735E8B1D0F5BC2A6C5C99711B2B1958)
permutation_round_key.append(0x1DB849552BEC3E70B8447BAEE23D2897E81F8A3AFCCF5F91F66BF9781BE322B2)
permutation_round_key.append(0x1A7A09D8D34387E13B9B5D786CC715E568B6CA39BAAE0E2D246F33C5ED47B194)
permutation_round_key.append(0x175F2F49ECDDC770F15E33C5F1EABF0F798FCCDB47D0CFF6BF25490619812C04)
permutation_round_key.append(0x0BF35CEB455DF243C98978A7D1C37E180BDCDA8C6AD39435574CCE62AEE910B7)
permutation_round_key.append(0x29442C39D376D983C64B08829F211C64A89CCA2CB7EB49509C3201093E137D80)


print("permutation round key")
a = ZZ(0)
for i in range(len(permutation_round_key)/4):
	print("[")
	for j in range(4):
		print(convert_bytes(int.to_bytes(int(permutation_round_key[4*i+j]), 32, 'little')))
	print("],")
    # a = a + ZZ(1)
    # if a%4 == 0:
	# 	print("],\n[")

print("==========================\n")



# t = [0x2122182A1DD6C6CB089442B10FC81BCF71B1860643DAB4B5D553ED9159BA27B1, 0x21560AEA899FBEFAE13418D802FBFC7F966D802A42669F4C49BD4E4B5809B5A5, 0x023B0BEB06E791767ED2A9FEC343593143B3FC86495EA75FF63CF0418A46984E]
# for e in t:
#     print(convert_bytes(int.to_bytes(int(e), 32, 'little')))
# print("==========================\n")
#
#
# t = [0x2122182A1DD6C6CB089442B10FC81BCF71B1860643DAB4B5D553ED9159BA27B1, 0x21560AEA899FBEFAE13418D802FBFC7F966D802A42669F4C49BD4E4B5809B5A5, 0x023B0BEB06E791767ED2A9FEC343593143B3FC86495EA75FF63CF0418A46984E, 0x2937E781F5252072620EA018598C4FD5B8241FC1532E1737E567DAF8AF66CE42]
# for e in t:
#     print(convert_bytes(int.to_bytes(int(e), 32, 'little')))
# print("==========================\n")


print("mds")
for e in rescue254.MDS:
    print("[")
    for f in e:
        print(convert_bytes(int.to_bytes(int(f), 32, 'little')))
    print("],")
print("==========================\n")

print("v0")
v0 = rescue254.Sponge([0,0,0,0], 4)
for e in v0:
	print(convert_bytes(int.to_bytes(int(e), 32, 'little')))
